---
title: "ETS Model"
author: "Michael Mayor"
date: "3/10/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(fpp)
library(dplyr)
library(tibble)
library(lubridate)
library(TSstudio)
```

```{r}
load(file = "./data/DOGE.Rdata")
```

```{r Clean Data}
dogeparsed$timestamp <- as.Date(dogeparsed$timestamp)
dogeparsed <- dogeparsed[c(1,9)]
doge_xts <- xts(dogeparsed[-1], order.by = dogeparsed$timestamp, frequency = 1)
colnames(doge_xts) <- c("close")
```

```{r}
doge_xts = doge_xts[,1][500:615]
tsdisplay(doge_xts) # As you can see from the ACF, this is not stationary
```

```{r}
tsdisplay(diff(doge_xts)) # After doing differencing, we have a better ACF that shows that we have white noise
```

```{r}
# We want to split our data into training and testing

train = doge_xts[,1][1:92]

test = doge_xts[,1][93:116]
```

```{r}
autoplot(doge_xts[-1], main = "Dogecoin", ylab = "USD", xlab = "Time")
```

```{r ETS Model}
fit_ets <- ets(train)
fc_ets <- forecast(fit_ets, h = length(test))
plot(forecast(fit_ets))
accuracy(fc_ets, test)
```

```{r Holt Winters}
fit1 <- hw(train) #additive Holt-Winters method
fit2 <- hw(train, seasonal="multiplicative") #multiplicative Holt-Winters method
fit3 <- hw(train, damped=TRUE) #additive Holt-Winter method with damped trend 
fit4 <- hw(train, seasonal="multiplicative", damped=TRUE) #multiplicative Holt-Winter method with damped trend 


plot(fit1, ylim=c(20,60))
lines(fit2$mean, col=2, lwd=2)
lines(fit3$mean, col=3, lwd=2)
lines(fit4$mean, col=5, lwd=2)
lines(test, lwd=2)
```